$(document).ready(function(){const a=$("#food-search"),b=$("#hide-food-search"),c=$("#dropdown1"),d=$("#error"),e=$("#sunday"),f=$("#monday"),g=$("#tuesday"),h=$("#wednesday"),i=$("#thursday"),j=$("#friday"),k=$("#saturday"),l=a=>moment().day(a).format("dddd, MMMM Do YYYY"),m=a=>parseInt(moment().day(a).format("M")),n=a=>parseInt(moment().day(a).format("D")),o=a=>parseInt(moment().day(a).format("YYYY")),p=(a,b)=>moment().week(a).day(b).format("dddd, MMMM Do YYYY"),q=(a,b)=>moment().week(a).day(b).format("MMMM Do YYYY"),r=(a,c)=>{let d=0,l=0,m=0,n=0,o=0;a.length?c?(console.log("data, past week"),e.empty().append(`<b>${p(a[0].weekOfYear,0)}</b>`),f.empty().append(`<b>${p(a[0].weekOfYear,1)}</b>`),g.empty().append(`<b>${p(a[0].weekOfYear,2)}</b>`),h.empty().append(`<b>${p(a[0].weekOfYear,3)}</b>`),i.empty().append(`<b>${p(a[0].weekOfYear,4)}</b>`),j.empty().append(`<b>${p(a[0].weekOfYear,5)}</b>`),k.empty().append(`<b>${p(a[0].weekOfYear,6)}</b>`)):(console.log("data, current week"),e.empty().append(`<b>${p(a[0].weekOfYear,0)}</b><span class="add" data-day="0">➕</span>`),f.empty().append(`<b>${p(a[0].weekOfYear,1)}</b><span class="add" data-day="1">➕</span>`),g.empty().append(`<b>${p(a[0].weekOfYear,2)}</b><span class="add" data-day="2">➕</span>`),h.empty().append(`<b>${p(a[0].weekOfYear,3)}</b><span class="add" data-day="3">➕</span>`),i.empty().append(`<b>${p(a[0].weekOfYear,4)}</b><span class="add" data-day="4">➕</span>`),j.empty().append(`<b>${p(a[0].weekOfYear,5)}</b><span class="add" data-day="5">➕</span>`),k.empty().append(`<b>${p(a[0].weekOfYear,6)}</b><span class="add" data-day="6">➕</span>`)):(console.log("no data"),console.log(u),e.empty().append(`<b>${p(u,0)}</b><span class="add" data-day="0">➕</span>`),f.empty().append(`<b>${p(u,1)}</b><span class="add" data-day="1">➕</span>`),g.empty().append(`<b>${p(u,2)}</b><span class="add" data-day="2">➕</span>`),h.empty().append(`<b>${p(u,3)}</b><span class="add" data-day="3">➕</span>`),i.empty().append(`<b>${p(u,4)}</b><span class="add" data-day="4">➕</span>`),j.empty().append(`<b>${p(u,5)}</b><span class="add" data-day="5">➕</span>`),k.empty().append(`<b>${p(u,6)}</b><span class="add" data-day="6">➕</span>`)),$("#sunday-calories").empty(),$("#sunday-carbs").empty(),$("#sunday-fat").empty(),$("#sunday-sodium").empty(),$("#sunday-cholesterol").empty(),$("#monday-calories").empty(),$("#monday-carbs").empty(),$("#monday-fat").empty(),$("#monday-sodium").empty(),$("#monday-cholesterol").empty(),$("#tuesday-calories").empty(),$("#tuesday-carbs").empty(),$("#tuesday-fat").empty(),$("#tuesday-sodium").empty(),$("#tuesday-cholesterol").empty(),$("#wednesday-calories").empty(),$("#wednesday-carbs").empty(),$("#wednesday-fat").empty(),$("#wednesday-sodium").empty(),$("#wednesday-cholesterol").empty(),$("#thursday-calories").empty(),$("#thursday-carbs").empty(),$("#thursday-fat").empty(),$("#thursday-sodium").empty(),$("#thursday-cholesterol").empty(),$("#friday-calories").empty(),$("#friday-carbs").empty(),$("#friday-fat").empty(),$("#friday-sodium").empty(),$("#friday-cholesterol").empty(),$("#saturday-calories").empty(),$("#saturday-carbs").empty(),$("#saturday-fat").empty(),$("#saturday-sodium").empty(),$("#saturday-cholesterol").empty(),$("#weekly-total-calories").empty(),$("#weekly-total-carbs").empty(),$("#weekly-total-fat").empty(),$("#weekly-total-sodium").empty(),$("#weekly-total-cholesterol").empty();for(const b of a)if(console.log(b),d+=Math.round(b.calories),l+=Math.round(b.fat),m+=Math.round(b.carbs),n+=Math.round(b.sodium),o+=Math.round(b.cholesterol),c)switch(b.dayID.toString()){case"0":e.append(`<br> ${b.food_item}`),$("#sunday-calories").append(`<br> ${Math.round(b.calories)}`),$("#sunday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#sunday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#sunday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#sunday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"1":f.append(`<br> ${b.food_item}`),$("#monday-calories").append(`<br> ${Math.round(b.calories)}`),$("#monday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#monday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#monday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#monday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"2":g.append(`<br> ${b.food_item}`),$("#tuesday-calories").append(`<br> ${Math.round(b.calories)}`),$("#tuesday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#tuesday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#tuesday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#tuesday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"3":h.append(`<br> ${b.food_item}`),$("#wednesday-calories").append(`<br> ${Math.round(b.calories)}`),$("#wednesday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#wednesday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#wednesday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#wednesday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"4":i.append(`<br> ${b.food_item}`),$("#thursday-calories").append(`<br> ${Math.round(b.calories)}`),$("#thursday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#thursday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#thursday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#thursday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"5":j.append(`<br> ${b.food_item}`),$("#friday-calories").append(`<br> ${Math.round(b.calories)}`),$("#friday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#friday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#friday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#friday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;default:k.append(`<br> ${b.food_item}`),$("#saturday-calories").append(`<br> ${Math.round(b.calories)}`),$("#saturday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#saturday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#saturday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#saturday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);}else switch(b.dayID.toString()){case"0":e.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#sunday-calories").append(`<br>${Math.round(b.calories)}`),$("#sunday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#sunday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#sunday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#sunday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"1":f.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#monday-calories").append(`<br> ${Math.round(b.calories)}`),$("#monday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#monday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#monday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#monday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"2":g.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#tuesday-calories").append(`<br> ${Math.round(b.calories)}`),$("#tuesday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#tuesday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#tuesday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#tuesday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"3":h.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#wednesday-calories").append(`<br> ${Math.round(b.calories)}`),$("#wednesday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#wednesday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#wednesday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#wednesday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"4":i.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#thursday-calories").append(`<br> ${Math.round(b.calories)}`),$("#thursday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#thursday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#thursday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#thursday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;case"5":j.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#friday-calories").append(`<br> ${Math.round(b.calories)}`),$("#friday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#friday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#friday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#friday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);break;default:k.append(`<br> ${b.food_item} <span class="delete" data-food-id="${b.id}">❌</span>`),$("#saturday-calories").append(`<br> ${Math.round(b.calories)}`),$("#saturday-carbs").append(`<br> ${Math.round(b.carbs)} g`),$("#saturday-fat").append(`<br> ${Math.round(b.fat)} g`),$("#saturday-sodium").append(`<br> ${Math.round(b.sodium)} mg`),$("#saturday-cholesterol").append(`<br> ${Math.round(b.cholesterol)} mg`);}$("#weekly-total-calories").append(`<b>${d} calories</b>`),$("#weekly-total-carbs").append(`<b>${m} g</b>`),$("#weekly-total-fat").append(`<b>${l} g</b>`),$("#weekly-total-sodium").append(`<b>${n} mg</b>`),$("#weekly-total-cholesterol").append(`<b>${o} mg</b>`),$(".add").on("click",function(){b.show(),$("#error-nav").hide(),v=$(this).data("day")}),$(".delete").on("click",function(){const a=$(this).data("food-id");console.log(a),$.ajax({url:`/api/delete/${a}`,type:"DELETE"}).then(()=>{location.reload()})})},s=a=>{$.get(`/api/previous-weeks/${a+"-display"}`,a=>{if(console.log(a),!a.length)return void console.log("no data");else{console.log("data");let d=a[a.length-1].weekOfYear;const e=[];for(let b=a.length-1;0<=b;b--)-1===e.indexOf(a[b].weekOfYear)&&(c.append(`<li class="previous-weeks" data-week-id="${d}"><a href="#!">${q(a[b].weekOfYear,0)} - ${q(a[b].weekOfYear,6)}</a></li>`),e.push(a[b].weekOfYear),d--);$(".previous-weeks").on("click",function(){b.hide(),console.log($(this).data("week-id"));const a=$(this).data("week-id");let c;c=a!==u,$.get(`/api/previous-weeks/${a}`,a=>{console.log(a),r(a,c)})});const f=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(f)}})},t=m(0)+"-"+n(0)+"-"+m(6)+"-"+n(6);let u,v;(()=>{b.hide(),$("#error-nav").hide(),$.get(`/api/currentweek/${t}`,a=>{console.log(t),console.log(a),a.length?(u=a[a.length-1].weekOfYear,console.log(u)):u=moment().week()}).then(a=>{r(a,!1),s(u)})})(),a.on("submit",a=>{a.preventDefault();const b=$("#food-item").val().trim();$("#food-item").val(""),$.post("/api/food",{food:b,date:l(v),month:m(v),day:n(v),year:o(v),dayID:v,weekOfYear:u}).then(a=>{a?(console.log("results found"),location.reload()):(console.log("no results"),$("#error-nav").show(),d.empty().append("No nutritional information was found."))})}),$("#icon2").on("click",()=>{b.hide(),$("#error-nav").hide()})});